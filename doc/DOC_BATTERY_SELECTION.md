# 배터리 선정 가이드

## 문제 상황

XBee Zigbee 모듈이 초기화 시 **약 60mA**의 전류를 소모하여, CR2032 코인 셀 배터리로는 동작 불가.

### 증상
- CR2032 연결 시 시스템 먹통
- 배터리 전압 강하로 MCU/XBee 리셋 반복

### 원인
CR2032는 용량(mAh)과 출력 전류(mA)가 다름:
- **용량**: ~220mAh (총 저장 에너지)
- **최대 출력 전류**: 3~5mA (한 번에 뽑을 수 있는 전류)
- **내부 저항**: 10~20Ω (높음)

60mA 출력 시 내부 저항에 의한 전압 강하:
```
V_drop = I × R = 60mA × 15Ω = 0.9V
V_out = 3.0V - 0.9V = 2.1V (동작 불가)
```

## 배터리 비교표

### 1차 전지 (일회용)

| 배터리 | 전압 | 용량 | 최대 전류 | 내부 저항 | 크기 | 적합성 |
|--------|------|------|-----------|-----------|------|--------|
| **CR2032** | 3.0V | 220mAh | 3~5mA | 10~20Ω | Ø20×3.2mm | ❌ 부적합 |
| **CR123A** | 3.0V | 1500mAh | 1.5A | <1Ω | Ø17×34mm | ✅ 적합 |
| **CR2** | 3.0V | 800mAh | 1A | <2Ω | Ø15×27mm | ✅ 적합 |
| **CR-P2 (223A)** | 6.0V | 1400mAh | 1.5A | <1Ω | 35×19×36mm | ✅ 적합 (전압 높음) |
| **2CR5** | 6.0V | 1500mAh | 1.5A | <1Ω | 34×17×45mm | ✅ 적합 (전압 높음) |
| **AA 리튬 (FR6)** | 1.5V | 3000mAh | 1A | <1Ω | Ø14×50mm | ⚠️ 2개 직렬 필요 |

### 2차 전지 (충전식)

| 배터리 | 전압 | 용량 | 최대 전류 | 크기 | 적합성 |
|--------|------|------|-----------|------|--------|
| **LIR2032** | 3.6V | 40mAh | 10~20mA | Ø20×3.2mm | ❌ 전류 부족 |
| **LiPo 301020** | 3.7V | 50mAh | 50mA | 3×10×20mm | ⚠️ 여유 적음 |
| **LiPo 401120** | 3.7V | 80mAh | 100mA | 4×11×20mm | ✅ 적합 |
| **LiPo 302020** | 3.7V | 100mAh | 100mA | 3×20×20mm | ✅ 적합 |
| **LiPo 603048** | 3.7V | 900mAh | 900mA+ | 6×30×48mm | ✅✅ 매우 적합 |
| **10440 (AAA)** | 3.7V | 350mAh | 500mA | Ø10×44mm | ✅ 적합 |
| **14500 (AA)** | 3.7V | 800mAh | 800mA | Ø14×50mm | ✅ 적합 |

## 선정 배터리: LiPo 603048

### 스펙

| 항목 | 값 |
|------|-----|
| 모델 | XK 603048 |
| 타입 | 리튬 폴리머 (LiPo) |
| 전압 | 3.7V (공칭), 4.2V (만충), 3.0V (방전 컷오프) |
| 용량 | 900mAh |
| 크기 | 6.0mm × 30mm × 48mm |
| 최대 방전 | 1C (900mA) 이상 |
| 자기 방전 | 월 ~3% |

### 크기 코드 해석
```
603048
│││││└─ 길이: 48mm
│││└──── 폭: 30mm
│└────── 두께: 6.0mm
```

### 장점
- 60mA 피크 전류 여유롭게 출력
- 충전 가능 (재사용)
- 자기 방전 낮음 (장기 보관 가능)
- 3.7V로 3.3V MCU 직접 구동 가능 (또는 LDO 사용)

### 주의사항
- 과방전 보호 필요 (3.0V 이하 방전 금지)
- 충전 회로 필요 (TP4056 등)
- 과충전 보호 필요 (4.2V 이상 충전 금지)

## 예상 배터리 수명

### 동작 조건
- 대기: MCU Stop + XBee Sleep = ~10µA
- 동작: MCU Run + XBee Active = ~60mA
- 동작 시간: 버튼 1회당 약 1초

### 계산 (하루 10회 사용 가정)

```
일일 소비량 = (10µA × 24h) + (60mA × 10회 × 1초 ÷ 3600)
           = 0.24mAh + 0.17mAh
           = 0.41mAh/일

예상 수명 = 900mAh ÷ 0.41mAh/일 ≈ 2195일 ≈ 6년
```

실제로는 자기 방전 등으로 **2~3년** 정도 예상.

## 대안: 하드웨어 수정

CR2032를 유지하고 싶다면:

### 1. 커패시터 추가
```
VCC ──┬── 100~470µF ──┬── GND
      │               │
      └─── 시스템 ────┘
```
피크 전류를 커패시터가 흡수.

### 2. XBee 전원 별도 제어
```
GPIO ── MOSFET ── XBee VCC
```
MCU 안정화 후 XBee 전원 인가.

### 3. 소프트 스타트
부팅 즉시 XBee Sleep 핀 HIGH로 설정하여 초기 전류 감소.

## 결론

| 요구사항 | CR2032 | LiPo 603048 |
|----------|--------|-------------|
| 60mA 피크 출력 | ❌ | ✅ |
| 소형 크기 | ✅ | ⚠️ 약간 큼 |
| 장기 보관 | ✅ | ✅ |
| 재사용 | ❌ | ✅ (충전) |
| 비용 | 저렴 | 중간 |

**XBee 사용 시 CR2032는 부적합. LiPo 603048 또는 유사 리튬 전지 권장.**

## 변경 이력

| 날짜 | 내용 |
|------|------|
| 2026-01-29 | 초기 작성 - CR2032 문제 및 LiPo 603048 선정 |
